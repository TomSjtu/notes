# 其他杂项

## 设备树

### 为什么需要设备数

具体可以参考Linus在2011年写的一个邮件：https://lkml.org/lkml/2011/3/17/492。

简单来说就是，ARM社区充斥着大量垃圾的、重复的描述板级信息的代码（arch/arm/mach-xxx），导致Linux内核十分的臃肿。因为Linux只是一个操作系统内核，它并不关心你开发板上有什么设备。于是ARM社区引入了PowerPC等架构已经采用的设备树。将这些描述硬件信息的内容从Linux内核中剥离出来，用一个单独的文件进行描述，这就是设备树文件.dts的由来。一个SOC可以制作很多开发板，这些开发板必然有一些通用的信息。将这些通用的信息提取出来作为一个通用的文件，其他的.dts文件直接引用通用文件即可，类似于C语言中的头文件。这个通用文件就是.dtsi文件。

一般情况下，.dtsi描述SOC信息，比如有几个CPU，主频是多少。.dts文件描述板级信息，比如开发板上有哪些IIC设备、SPI设备等。


### DTS、DTB和DTC的关系

.dts是源码文件，DTC负责将.dts编译成.dtb。而.dtb就是负责传递给内核识别的二进制文件。

make dtbs编译所有的dts文件，如果要编译指定的dtb，请使用make board_name.dtb。

在arch/arm/boot/dts/Makefile文件里列出了单个SOC需要编译的.dtb文件。

如果我们使用了I.MX6ULL新做了一个板子，只需要新建一个对应的.dts文件，并且将对应的.dtb文件添加到dtb-${CONFIG_SOC_IMX6ULL}下。

### DTS基本语法

实际开发不会让你重新写一个.dts文件